image: maven:3-jdk-8

environment:
  - GPG_PASSPHRASE
  - GITHUB_OAUTH_TOKEN
  - NEXUS_PASSWORD
  - OOTPAI_SITE
  - OOTPAI_CLEAR_CACHE
  - OOTPAI_PLAYOFFS
  - OOTPAI_DATA=./ootp-ai-data
  - GIT_AUTHOR_NAME
  - GIT_AUTHOR_EMAIL

volumes:
  - etc/settings.xml:/root/.m2/settings.xml

targets:
  build: mvn -B clean verify -Dgpg.skip=true -DaddScalacArgs=-feature

  clean: mvn -B clean

  update-versions: mvn -B versions:update-properties -DgenerateBackupPoms=false

  site: mvn -B -e clean site

  run:
    volumes:
      - $GIT_SSH_KEY:/ssh/id_rsa:ro
    run: /bin/bash construi/run/run.sh

